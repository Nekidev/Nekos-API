import { Callout } from 'nextra-theme-docs'

# Reference

This page will help you understand how to use the Rest API. We highly recommend reading this before starting to use the API.

## Rate limits

The API has a rate limit of **1 request per second**. If you exceed this limit, you will receive a 429 response. You can use the `Retry-After` and the `X-RateLimit-Reset` header to determine how long to wait before retrying.

If you exceed the rate limit 10 times in the same hour, you'll get blocked for an hour.

## Authentication

The API does not require any kind of authentication for regular users. You can go ahead and start using it right away.

If you have an access token, you need to set an `Authorization` header with the token as the value.

```copy=false
Authorization: Bearer <token>
```

## Responses

The API will always return a JSON object. The response will have the following structure:

```js
{
    "success": Boolean,
    "data": Object
}
```

## Pagination

The API uses a limit/offset based pagination system. You can use the limit and offset query parameters to paginate through the results. For example:

```
GET /api/image?limit=10&offset=0 HTTP/1.1
```

The default limit is 10 and the maximum limit is 25.

## Searching (beta)

In some endpoints there is a `search` query parameter that you can use to filter the results. The queries can be done using PostgreSQL FTS operators, which are:

| Operator    | Description                          | Example                                                                                                                                           |
| :---------- | :----------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------ |
| `&`         | Contains both terms                  | `dog & fox` matches `The dog and the fox` because it contains both `dog` and `fox`                                                                |
| `!`         | Does not contain the term            | `!dog` matches `The cow and the fox` because it does not contain the term `dog`                                                                   |
| `\|`        | Contains at least one of the terms   | `dog \| fox` matches `The cow and the fox` because it contains fox. It's not necessary to match both                                              |
| `<->`       | Contains both in the specified order | `dog <-> fox` matches `The dog and the fox` because it contains both `dog` and `fox` and `fox` is after `dog`                                     |
| `(` and `)` | Combine multiple operations          | `!cat & (dog \| fox)` matches `The dog is flying` because it does not contain `cat` and it contains `dog`. It is not necessary to match `fox` too |

<Callout type="warning">
    Since the database framework the API uses to connect to the database is having some problems with multi-word queries (i.e. `kaguya sama | dog` because the term "kaguya sama" has 2 words), these type of queries are being converted to `<->` queries, which is the current best replacement. You can override this behaviour by using your own operators (i.e. `(kaguya & sama) | dog`).
</Callout>

## Errors

If an error occurs, the API will return a JSON object with the following structure:

```js
{
    "code": Integer,
    "message": String,
    "success": false
}
```
